{%extends 'base.html'%}
{%load static%}
{%block title%}
    {%if type_m == 'inbox'%}
        Входящие
    {%elif type_m == 'sent'%}
        Исходящие
    {%elif type_m == 'trash'%}
        Удаленные
    {%elif type_m == 'favourite'%}
        Избранные
    {%elif type_m == 'draft'%}
        Черновики
    {%endif%}
{%endblock%}
{%block content%}
    <div id="main" role="main" aria-label="Рабочая область">
        <input type="hidden" name="_ckey" value="Y9MpI8J3LItmQPK9pcEB8p2GB2Y=!ktbuv2q1">
        <input type="hidden" name="_handlers" value="do-messages">
        <input type="hidden" name="retpath" value="/">
        
    <div class="b-messages">
        {%for message in messages%}
            <div class="b-messages__message {%if message.in_route%}b-messages__message_thread{%endif%} {%if not message.read and type_m == 'inbox'%}b-messages__message_unread{%endif%}">
                <input type="hidden" name="msg_id" value="{{message.id}}">
                <label class="b-messages__message__checkbox">
                    <input type="checkbox" name="ids" class="b-form-checkbox" value="176766285374292674" aria-label=" Получено {{message.date|date:'d m '}}">
                </label>
                <div class="b-messages__message__flag" aria-hidden="true">
                    {%if not message.read and type_m == 'inbox'%}
                    <img class="b-mail-icon b-mail-icon_new" src="{%static 'img/b-messages__message_new.png'%}" alt="*" role="presentation">
                    {%endif%}
                </div>
                {%if message.files.all%}
                    <span class="b-messages__size" aria-hidden="true">
                        <img class="b-mail-icon b-mail-icon_attach" alt="@" src="{% static 'img/b-messages__message_attach.gif'%}" role="presentation">
                        <span class="b-messages__size__width">{{message.get_size_files|filesizeformat}}</span>
                    </span>
                {%endif%}
                <!-- <div class="b-messages__message__flag" aria-hidden="true"></div> -->
                <span class="b-messages__date" role="presentation" aria-hidden="true" title="Получено {{message.date|date:'d m '}} в {{message.date|timesince}}">
                    <span>{{message.date|date:"d b"}}</span>
                </span> 
                <span class="b-messages__message__left" href="{{message.get_absolute_url}}">
                    {%if type_m == 'sent'%}
                    <a class="b-messages__from" href="{{message.get_absolute_url}}" aria-label="Получатель: {{message.receiver.username}}">
                        <span class="b-messages__from__text" aria-hidden="true" role="presentation">
                            <span class="b-messages__from__text">{{message.receiver.username}}</span>
                        </span>
                    </a>
                    {%else%}
                    <a class="b-messages__from" href="{{message.get_absolute_url}}" aria-label="Отправитель: {{message.sender.username}}">
                        <span class="b-messages__from__text" aria-hidden="true" role="presentation">
                            <span class="b-messages__from__text">{{message.sender.username}}</span>
                        </span>
                    </a>
                    {%endif%} 
                    <a href="{{message.get_absolute_url}}" class="b-messages__message__link" aria-label="{{message.topic}}">
                        <span aria-hidden="true" role="presentation">
                            <span class="b-messages__subject">
                                <span>{{message.topic}}</span>
                            </span> 
                            <span class="b-messages__firstline">
                                {{message.text_message}}
                            </span>&nbsp;
                        </span>
                    </a>
                </span>
            </div>
        {%endfor%}
        
        <div class="b-messages__check-all"><input id="check-all" class="b-form-checkbox pda-action"
                type="checkbox" data-action="check-all"><label for="check-all"
                class="b-form-label">выбрать все</label></div>
    </div>
    </div>
    <div class="b-pager">
    <span class="b-pager__title" aria-hidden="true"
        role="presentation">Страницы
    </span> 
    <span class="b-pager__links">
        {% if prev_url %}
        <span class="b-pager__active">
            <a class="b-pager__prev"
                href="?{{prev_url}}"
                aria-label="Предыдущая страница">
                <span aria-hidden="true"role="presentation">
                    <i class="b-pager__arr">←</i>
                    предыдущая&nbsp;

                </span>
            </a>
        </span>
        {% else %}
        <span class="b-pager__inactive b-pager__left" aria-hidden="true" role="presentation">
            <i class="b-pager__arr">←</i>
            &nbsp;предыдущая
        </span>
        {% endif %}
        {% if next_url %}
        <span class="b-pager__active">
            <a class="b-pager__next"
                href="?{{next_url}}"
                aria-label="Следующая страница">
                <span aria-hidden="true"
                    role="presentation">следующая&nbsp;
                    <i class="b-pager__arr">→</i>
                </span>
            </a>
        </span>
        {% else %}
        <span class="b-pager__inactive b-pager__right" aria-hidden="true" role="presentation">
            &nbsp;следующая
            <i class="b-pager__arr">→</i>
        </span>
        {% endif %}
    </span>
</div>
{%endblock%}